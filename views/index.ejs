<% include ./partials/header %>

<div class='container'>
        <!-- ASSIGN RANDOM BANNER OUT OF 10 IMAGE FILES -->
    <% let random = Math.floor(Math.random() * 10) %>
    <div class='banner' style='background-image:url(/images/banner<%=random%>.png)''>
        <img class='logo' src='/images/logo.png'>
        <h1 class='heading'>Top Articles</h1>
    </div>
    <div class="flex-container">

        <!-- CREATE ARTICLE BOX USING API CONTENT -->
    <% data.articles.forEach(function(story) { %>
        <% let author = story['author'] %>
            <!-- STOPS AUTHOR COLLABORATIONS FROM BREAKING THE FORMAT -->
        <% if (author && author.length > 30) { author = 'Multiple authors' } %>
        <% let time = new Date(story['publishedAt']) %>
        <% let title = story['title'] %>
        <% let url = story['url'] %>
        <% let description = story['description'] %>
        <% let link = 'Read the full article...' %>        
        <% let image = story['urlToImage'] %>
        <% let imageNoSpaces = image.replace(/\s+/g,"%20")%> <!-- REPLACES SPACES WITH '%20' TO AVOID BLANK IMAGES -->

        <ul>
            <li class='date'><%= time.toDateString() %></li>
            <li class='title'><a href='<%=url%>' target='_blank'><h3><%= title %></h3></a></li>
                <!-- CHECKS TO MAKE SURE AUTHOR ISN'T NULL BEFORE CREATING AUTHOR LI -->
            <% if (author) { %> <li>BY <span class='author'><%= author %><span></li> <% } %>
            <li class='image'><img src='<%=imageNoSpaces%>'></li>

            <% if (description && description != "") { %> <li class='desc'><%= description %></li> <% } %>

            <li class='link'><a href='<%=url%>' target='_blank'><%= link %></a></li>
        </ul>
        
    <% }); %>
    </div>
</div>

<% include ./partials/footer %>